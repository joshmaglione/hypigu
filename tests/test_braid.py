import unittest
from sage.all import QQ, polygens
from hypigu.braid import _Poincare_prod, _recursive_crank, BraidArrangementIgusa

class TestBraidFunctions(unittest.TestCase):

    def test_Poincare_prod(self):
        self.assertEqual(str(_Poincare_prod([1, 1])), 'Y + 1')
        self.assertEqual(str(_Poincare_prod([4, 1, 2])), '2*Y^2 + 3*Y + 1')
        self.assertEqual(str(_Poincare_prod([1]*6)), '120*Y^5 + 274*Y^4 + 225*Y^3 + 85*Y^2 + 15*Y + 1')

    def test_recursive_crank(self):
        q, t = polygens(QQ, 'q,t')
        self.assertEqual(str(_recursive_crank(q, t, 4)), '(6*q^7*t^9 - 12*q^6*t^10 - 24*q^5*t^11 + 4*q^9*t^6 + 12*q^8*t^7 - 16*q^7*t^8 - 15*q^6*t^9 + 70*q^5*t^10 + 50*q^4*t^11 - 25*q^8*t^6 - 30*q^7*t^7 + 70*q^6*t^8 - 100*q^4*t^10 - 35*q^3*t^11 + 9*q^10*t^3 + 12*q^9*t^4 - 6*q^8*t^5 + 50*q^7*t^6 - 95*q^5*t^8 + 15*q^4*t^9 + 50*q^3*t^10 + 10*q^2*t^11 + q^12 + 8*q^11*t + 6*q^10*t^2 - 50*q^9*t^3 - 30*q^8*t^4 + 35*q^7*t^5 - 35*q^6*t^6 + 30*q^5*t^7 + 50*q^4*t^8 - 6*q^3*t^9 - 8*q^2*t^10 - q*t^11 - 10*q^11 - 50*q^10*t - 15*q^9*t^2 + 95*q^8*t^3 - 50*q^6*t^5 + 6*q^5*t^6 - 12*q^4*t^7 - 9*q^3*t^8 + 35*q^10 + 100*q^9*t - 70*q^7*t^3 + 30*q^6*t^4 + 25*q^5*t^5 - 50*q^9 - 70*q^8*t + 15*q^7*t^2 + 16*q^6*t^3 - 12*q^5*t^4 - 4*q^4*t^5 + 24*q^8 + 12*q^7*t - 6*q^6*t^2)/(-q^2*t^19 + 2*q*t^20 - t^21 + q^4*t^16 - 2*q^3*t^17 + q^2*t^18 + q^5*t^13 - 2*q^4*t^14 + q^3*t^15 - q^7*t^10 + 2*q^6*t^11 - q^5*t^12 + q^6*t^9 - 2*q^5*t^10 + q^4*t^11 - q^8*t^6 + 2*q^7*t^7 - q^6*t^8 - q^9*t^3 + 2*q^8*t^4 - q^7*t^5 + q^11 - 2*q^10*t + q^9*t^2)')

    def test_BraidArrangementIgusa(self):
        self.assertEqual(str(BraidArrangementIgusa(1)), '(q - 1)/(q - t)')
        self.assertEqual(str(BraidArrangementIgusa(5)), '(36*q^10*t^22 - 108*q^9*t^23 - 72*q^8*t^24 + 144*q^7*t^25 - 12*q^12*t^19 + 156*q^11*t^20 - 96*q^10*t^21 - 210*q^9*t^22 + 636*q^8*t^23 + 24*q^7*t^24 - 468*q^6*t^25 - 24*q^14*t^16 - 48*q^13*t^17 + 168*q^12*t^18 - 132*q^11*t^19 - 792*q^10*t^20 + 792*q^9*t^21 + 256*q^8*t^22 - 1365*q^7*t^23 + 270*q^6*t^24 + 680*q^5*t^25 + 242*q^13*t^16 + 144*q^12*t^17 - 924*q^11*t^18 + 928*q^10*t^19 + 1470*q^9*t^20 - 1860*q^8*t^21 + 60*q^7*t^22 + 1575*q^6*t^23 - 540*q^5*t^24 - 555*q^4*t^25 - 48*q^15*t^13 + 24*q^14*t^14 + 96*q^13*t^15 - 1005*q^12*t^16 + 129*q^11*t^17 + 2046*q^10*t^18 - 2202*q^9*t^19 - 1410*q^8*t^20 + 2280*q^7*t^21 - 446*q^6*t^22 - 1017*q^5*t^23 + 492*q^4*t^24 + 251*q^3*t^25 - 6*q^17*t^10 - 42*q^16*t^11 + 12*q^15*t^12 + 342*q^14*t^13 - 348*q^13*t^14 - 312*q^12*t^15 + 2179*q^11*t^16 - 1035*q^10*t^17 - 2415*q^9*t^18 + 2717*q^8*t^19 + 594*q^7*t^20 - 1584*q^6*t^21 + 480*q^5*t^22 + 309*q^4*t^23 - 204*q^3*t^24 - 57*q^2*t^25 + 67*q^16*t^10 + 294*q^15*t^11 - 204*q^14*t^12 - 892*q^13*t^13 + 1200*q^12*t^14 + 210*q^11*t^15 - 2601*q^10*t^16 + 1773*q^9*t^17 + 1647*q^8*t^18 - 1863*q^7*t^19 + 42*q^6*t^20 + 528*q^5*t^21 - 206*q^4*t^22 - 30*q^3*t^23 + 30*q^2*t^24 + 5*q*t^25 - 285*q^15*t^10 - 750*q^14*t^11 + 771*q^13*t^12 + 1122*q^12*t^13 - 1872*q^11*t^14 + 114*q^10*t^15 + 1783*q^9*t^16 - 1509*q^8*t^17 - 621*q^7*t^18 + 677*q^6*t^19 - 60*q^5*t^20 - 60*q^4*t^21 + 30*q^3*t^22 - 12*q^15*t^9 + 691*q^14*t^10 + 954*q^13*t^11 - 1363*q^12*t^12 - 577*q^11*t^13 + 1776*q^10*t^14 - 416*q^9*t^15 - 690*q^8*t^16 + 666*q^7*t^17 + 99*q^6*t^18 - 123*q^5*t^19 - 14*q^17*t^6 - 48*q^16*t^7 + 48*q^15*t^8 - 16*q^14*t^9 - 1299*q^13*t^10 - 468*q^12*t^11 + 1473*q^11*t^12 - 447*q^10*t^13 - 822*q^9*t^14 + 507*q^8*t^15 + 116*q^7*t^16 - 120*q^6*t^17 + 10*q^4*t^19 + 129*q^16*t^6 + 243*q^15*t^7 - 378*q^14*t^8 + 366*q^13*t^9 + 1708*q^12*t^10 - 744*q^11*t^11 - 751*q^10*t^12 + 767*q^9*t^13 - 90*q^8*t^14 - 245*q^7*t^15 - 18*q^18*t^3 - 36*q^17*t^4 + 36*q^16*t^5 - 427*q^15*t^6 - 345*q^14*t^7 + 1035*q^13*t^8 - 965*q^12*t^9 - 990*q^11*t^10 + 1200*q^10*t^11 - 66*q^9*t^12 - 297*q^8*t^13 + 162*q^7*t^14 + 51*q^6*t^15 - q^20 - 12*q^19*t - 18*q^18*t^2 + 166*q^17*t^3 + 120*q^16*t^4 - 330*q^15*t^5 + 765*q^14*t^6 - 105*q^13*t^7 - 1275*q^12*t^8 + 987*q^11*t^9 + 54*q^10*t^10 - 504*q^9*t^11 + 158*q^8*t^12 + 30*q^7*t^13 - 30*q^6*t^14 - 5*q^5*t^15 + 15*q^19 + 120*q^18*t + 75*q^17*t^2 - 570*q^16*t^3 + 120*q^15*t^4 + 750*q^14*t^5 - 871*q^13*t^6 + 633*q^12*t^7 + 717*q^11*t^8 - 449*q^10*t^9 + 60*q^9*t^10 + 60*q^8*t^11 - 30*q^7*t^12 - 85*q^18 - 420*q^17*t + 15*q^16*t^2 + 850*q^15*t^3 - 720*q^14*t^4 - 450*q^13*t^5 + 546*q^12*t^6 - 498*q^11*t^7 - 147*q^10*t^8 + 99*q^9*t^9 + 225*q^17 + 600*q^16*t - 345*q^15*t^2 - 492*q^14*t^3 + 636*q^13*t^4 - 66*q^12*t^5 - 128*q^11*t^6 + 120*q^10*t^7 - 10*q^8*t^9 - 274*q^16 - 288*q^15*t + 363*q^14*t^2 + 64*q^13*t^3 - 120*q^12*t^4 + 60*q^11*t^5 + 120*q^15 - 90*q^13*t^2)/(q^3*t^37 - 3*q^2*t^38 + 3*q*t^39 - t^40 - 2*q^5*t^34 + 6*q^4*t^35 - 6*q^3*t^36 + 2*q^2*t^37 + q^7*t^31 - 3*q^6*t^32 + 3*q^5*t^33 - q^4*t^34 - q^6*t^31 + 3*q^5*t^32 - 3*q^4*t^33 + q^3*t^34 + 2*q^8*t^28 - 6*q^7*t^29 + 6*q^6*t^30 - 2*q^5*t^31 - q^10*t^25 + 3*q^9*t^26 - 3*q^8*t^27 + q^7*t^28 - q^7*t^27 + 3*q^6*t^28 - 3*q^5*t^29 + q^4*t^30 + 2*q^9*t^24 - 6*q^8*t^25 + 6*q^7*t^26 - 2*q^6*t^27 - q^11*t^21 + 3*q^10*t^22 - 3*q^9*t^23 + q^8*t^24 + q^10*t^21 - 3*q^9*t^22 + 3*q^8*t^23 - q^7*t^24 - 2*q^12*t^18 + 6*q^11*t^19 - 6*q^10*t^20 + 2*q^9*t^21 - q^8*t^22 + 3*q^7*t^23 - 3*q^6*t^24 + q^5*t^25 + q^14*t^15 - 3*q^13*t^16 + 3*q^12*t^17 - q^11*t^18 + 2*q^10*t^19 - 6*q^9*t^20 + 6*q^8*t^21 - 2*q^7*t^22 - q^12*t^16 + 3*q^11*t^17 - 3*q^10*t^18 + q^9*t^19 + q^11*t^16 - 3*q^10*t^17 + 3*q^9*t^18 - q^8*t^19 - 2*q^13*t^13 + 6*q^12*t^14 - 6*q^11*t^15 + 2*q^10*t^16 + q^15*t^10 - 3*q^14*t^11 + 3*q^13*t^12 - q^12*t^13 + q^12*t^12 - 3*q^11*t^13 + 3*q^10*t^14 - q^9*t^15 - 2*q^14*t^9 + 6*q^13*t^10 - 6*q^12*t^11 + 2*q^11*t^12 + q^16*t^6 - 3*q^15*t^7 + 3*q^14*t^8 - q^13*t^9 - q^15*t^6 + 3*q^14*t^7 - 3*q^13*t^8 + q^12*t^9 + 2*q^17*t^3 - 6*q^16*t^4 + 6*q^15*t^5 - 2*q^14*t^6 - q^19 + 3*q^18*t - 3*q^17*t^2 + q^16*t^3)')
        with self.assertRaises(ValueError):
            BraidArrangementIgusa(-1)

if __name__ == '__main__':
    unittest.main()
